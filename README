Thanks to Tom for his idea of automated monadification.
